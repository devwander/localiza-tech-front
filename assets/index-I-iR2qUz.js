import{c as v,r as i,j as e,u as G,b as R,d as J,L as K,P,M as $,e as X,f as D,S as Y,g as ee,h as se,i as ae,T as te,y as b}from"./index-Zo4AEdua.js";import{M as _,u as re,a as le,b as oe}from"./map.model-DHSsXJHY.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],ne=v("building-2",ie);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],de=v("check",ce);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ue=v("eye",me);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],he=v("share-2",xe);function pe({isOpen:x,onClose:h,onSubmit:w,isLoading:l=!1}){const[p,c]=i.useState(""),[d,o]=i.useState(""),[f,g]=i.useState([]);if(!x)return null;const M=t=>{t.preventDefault(),p.trim()&&w(p.trim(),d.trim()||void 0,f.length>0?f:void 0)},y=()=>{l||(c(""),o(""),g([]),h())},j=t=>{g(m=>m.includes(t)?m.filter(k=>k!==t):[...m,t])};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:y}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Criar Novo Mapa"}),e.jsx("button",{onClick:y,disabled:l,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"mapName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Nome do Mapa ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"mapName",value:p,onChange:t=>c(t.target.value),placeholder:"Ex: Feira de Tecnologia 2024",required:!0,disabled:l,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mapDescription",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição (opcional)"}),e.jsx("textarea",{id:"mapDescription",value:d,onChange:t=>o(t.target.value),placeholder:"Adicione uma descrição para o mapa...",rows:3,disabled:l,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (opcional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(_).map(([t,m])=>e.jsx("button",{type:"button",onClick:()=>j(t),disabled:l,className:`px-3 py-1.5 text-sm font-medium rounded-full transition-all ${f.includes(t)?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"} disabled:opacity-50 disabled:cursor-not-allowed`,children:m},t))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Selecione uma ou mais tags para categorizar o mapa"})]})]}),e.jsxs("div",{className:"mt-6 flex space-x-3 justify-end",children:[e.jsx("button",{type:"button",onClick:y,disabled:l,className:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:l||!p.trim(),className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Criando..."]}):"Criar Mapa"})]})]})]})]})})}function fe(){const x=G(),[h,w]=i.useState(""),[l,p]=i.useState(""),[c,d]=i.useState(1),[o,f]=i.useState("most_recent"),[g,M]=i.useState("all"),[y,j]=i.useState(!1),[t,m]=i.useState(null);i.useEffect(()=>{const s=setTimeout(()=>{p(h)},500);return()=>{clearTimeout(s)}},[h]);const k=o==="a_z"||o==="z_a"?"alphabetical":o,{data:C,isLoading:S}=R(),{data:u,isLoading:A,isError:F,error:L}=J({query:l||void 0,tags:g!=="all"?g:void 0,page:c,limit:10,order:k});let n=u;if(u&&u.data&&(o==="a_z"||o==="z_a")){const s=[...u.data];o==="a_z"?s.sort((a,r)=>a.name.localeCompare(r.name)):o==="z_a"&&s.sort((a,r)=>r.name.localeCompare(a.name)),n={...u,data:s}}const z=re(),T=le(),q=async(s,a)=>{if(confirm(`Tem certeza que deseja excluir o mapa "${a}"?`))try{await z.mutateAsync(s),b.success("Mapa excluído com sucesso!")}catch(r){b.error("Erro ao excluir mapa"),console.error(r)}},E=()=>{j(!0)},B=()=>{j(!1)},O=async(s,a,r)=>{try{const N=await T.mutateAsync({name:s,metadata:{description:a},tags:r,features:[]});b.success("Mapa criado com sucesso!"),j(!1),x(`/dashboard/maps/${N._id}`)}catch(N){b.error("Erro ao criar mapa"),console.error(N)}},V=s=>{x(`/dashboard/maps/${s}`)},I=s=>{x(`/dashboard/maps/${s}`)},Q=async(s,a)=>{const r=`${window.location.origin}/maps/public/${s}`;try{await navigator.clipboard.writeText(r),m(s),b.success(`Link do mapa "${a}" copiado!`),setTimeout(()=>{m(null)},2e3)}catch(N){console.error("Failed to copy:",N),b.error("Erro ao copiar link")}},H=s=>{x(`/stores/${s}`)};if(A)return e.jsx(K,{});if(F)return e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-red-800",children:["Erro ao carregar mapas: ",L?.message||"Erro desconhecido"]})})});const U=u?.total||0,W=u?.data.reduce((s,a)=>s+(a.features?.length||0),0)||0,Z=u?.data.filter(s=>s.tags&&s.tags.length>0).length||0;return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-8 mt-20",children:[e.jsx(pe,{isOpen:y,onClose:B,onSubmit:O,isLoading:T.isPending}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Meus Mapas"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gerencie seus mapas de feiras, polos comerciais e eventos."})]}),e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(P,{className:"mr-2 h-5 w-5"}),"Novo Mapa"]})]})}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 mb-1",children:[e.jsx($,{size:14,className:"text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Total de Mapas"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:U})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 mb-1",children:[e.jsx(X,{size:14,className:"text-green-600"}),e.jsx("span",{className:"font-medium",children:"Total de Espaços"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:W})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 mb-1",children:[e.jsx(D,{size:14,className:"text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Mapas Publicados"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Z})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Buscar mapas"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l!==h?e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Y,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",id:"search",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Buscar mapa por nome...",value:h,onChange:s=>{w(s.target.value),d(1)}})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"sr-only",children:"Filtrar por tipo"}),e.jsxs("select",{id:"type",className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:g,onChange:s=>{M(s.target.value),d(1)},disabled:S,children:[e.jsx("option",{value:"all",children:S?"Carregando...":"Todos os tipos"}),C&&C.length>0?C.map(s=>e.jsx("option",{value:s,children:_[s]||s.charAt(0).toUpperCase()+s.slice(1)},s)):!S&&e.jsx("option",{disabled:!0,children:"Nenhuma tag disponível"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"order",className:"sr-only",children:"Ordenar por"}),e.jsxs("select",{id:"order",className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:o,onChange:s=>{f(s.target.value),d(1)},children:[e.jsx("option",{value:"most_recent",children:"Mais recentes"}),e.jsx("option",{value:"oldest",children:"Mais antigos"}),e.jsx("option",{value:"a_z",children:"A-Z"}),e.jsx("option",{value:"z_a",children:"Z-A"})]})]})]})}),n&&n.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.data.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition-shadow duration-200 overflow-hidden",children:[e.jsx("div",{className:"w-full bg-gray-50 flex items-center justify-center p-4",children:e.jsx(ee,{map:s,width:280,height:180})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:s.name}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:s.tags&&s.tags.length>0?s.tags.map(a=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${oe[a]}`,children:_[a]},a)):s.type?(()=>{const a=s.type.toLowerCase();let r="bg-green-100 text-green-800";return a==="evento"?r="bg-pink-100 text-pink-800":a==="shopping"&&(r="bg-blue-100 text-blue-800"),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r}`,children:s.type.charAt(0).toUpperCase()+s.type.slice(1)})})():null})]})}),s.metadata?.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:s.metadata.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{size:14}),e.jsxs("span",{children:[s.features.length," espaços cadastrados"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{size:14}),e.jsx("span",{children:s.createdAt?new Date(s.createdAt).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Data desconhecida"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>I(s._id),className:"flex-1 inline-flex justify-center items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(ue,{className:"mr-1 h-4 w-4"}),"Visualizar"]}),e.jsxs("button",{onClick:()=>V(s._id),className:"flex-1 inline-flex justify-center items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(ae,{className:"mr-1 h-4 w-4"}),"Editar"]}),e.jsx("button",{onClick:()=>Q(s._id,s.name),className:"inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Compartilhar link público",children:t===s._id?e.jsx(de,{className:"h-4 w-4 text-green-600"}):e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>q(s._id,s.name),disabled:z.isPending,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(te,{className:"h-4 w-4"})})]}),e.jsxs("button",{onClick:()=>H(s._id),className:"w-full inline-flex justify-center items-center px-3 py-2 border border-blue-300 text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(ne,{className:"mr-1 h-4 w-4"}),"Gerenciar Espaços"]})]})]})]},s._id))}),n.totalPages>1&&e.jsxs("div",{className:"mt-8 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando"," ",e.jsx("span",{className:"font-medium",children:(c-1)*10+1})," a"," ",e.jsx("span",{className:"font-medium",children:Math.min(c*10,n.total)})," ","de ",e.jsx("span",{className:"font-medium",children:n.total})," ","resultados"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>d(s=>Math.max(1,s-1)),disabled:c===1,className:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsx("button",{onClick:()=>d(s=>Math.min(n.totalPages,s+1)),disabled:c===n.totalPages,className:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Próxima"})]})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[e.jsx($,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhum mapa encontrado"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comece criando um novo mapa de feira, shopping ou evento."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(P,{className:"mr-2 h-5 w-5"}),"Criar Novo Mapa"]})})]})]})]})}export{fe as MapList};
