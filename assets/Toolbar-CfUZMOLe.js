import{r as i,j as s,v as xe,k as he,n as ge}from"./index-Zo4AEdua.js";function fe({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const be=i.forwardRef(fe);function pe({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const ve=i.forwardRef(pe);function ye({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 21v-7.5a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 .75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349M3.75 21V9.349m0 0a3.001 3.001 0 0 0 3.75-.615A2.993 2.993 0 0 0 9.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 0 0 2.25 1.016c.896 0 1.7-.393 2.25-1.015a3.001 3.001 0 0 0 3.75.614m-16.5 0a3.004 3.004 0 0 1-.621-4.72l1.189-1.19A1.5 1.5 0 0 1 5.378 3h13.243a1.5 1.5 0 0 1 1.06.44l1.19 1.189a3 3 0 0 1-.621 4.72M6.75 18h3.75a.75.75 0 0 0 .75-.75V13.5a.75.75 0 0 0-.75-.75H6.75a.75.75 0 0 0-.75.75v3.75c0 .414.336.75.75.75Z"}))}const we=i.forwardRef(ye);function je({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243-1.59-1.59"}))}const ke=i.forwardRef(je);function Ce({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42"}))}const Ne=i.forwardRef(Ce);function Ee({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 0 1-1.125-1.125v-3.75ZM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-8.25ZM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-2.25Z"}))}const X=i.forwardRef(Ee);function Le({debugInfo:n,selectedElement:e,visible:r}){return r?s.jsxs("div",{className:"p-3 bg-gray-50 border-t",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Debug Info"}),s.jsxs("div",{className:"space-y-2 text-xs font-mono",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600 text-xs",children:"Mouse:"}),s.jsxs("div",{className:"text-xs",children:[n.mousePos.x,", ",n.mousePos.y]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600 text-xs",children:"Canvas:"}),s.jsxs("div",{className:"text-xs",children:[Math.round(n.canvasPos.x),","," ",Math.round(n.canvasPos.y)]})]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600 text-xs",children:"Selecionado:"}),s.jsx("div",{className:"text-xs",children:e?`${e.name} (${e.layer})`:"Nenhum"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600 text-xs",children:"Hit Test:"}),s.jsx("div",{className:"max-h-16 overflow-y-auto text-xs",children:n.lastHitTest.map((t,a)=>s.jsx("div",{className:t.includes("âœ“")?"text-green-600":"text-red-600",children:t},a))})]})]})]}):null}const Me={Corredor:{color:"#E5E7EB",borderColor:"#9CA3AF",icon:"ðŸ›¤ï¸"},PraÃ§a:{color:"#D1FAE5",borderColor:"#10B981",icon:"ðŸ›ï¸"},"Ãrea Comum":{color:"#DBEAFE",borderColor:"#3B82F6",icon:"ðŸ‘¥"},Entrada:{color:"#FEF3C7",borderColor:"#F59E0B",icon:"ðŸšª"},Banheiro:{color:"#EDE9FE",borderColor:"#8B5CF6",icon:"ðŸš»"},Customizado:{color:"#F3F4F6",borderColor:"#6B7280",icon:"âš™ï¸"}},Q={AlimentaÃ§Ã£o:"#4CAF50",VestuÃ¡rio:"#2196F3",Artesanato:"#FF9800",ServiÃ§os:"#9C27B0",Outros:"#607D8B"},q={tolerance:5,handleSize:8};class R{static createEmptyLayers(){return{background:[],submaps:[],locations:[]}}static getAllElementsOrdered(e){return[...e.background,...e.submaps,...e.locations]}static getAllElementsReverseOrder(e){return[...e.locations.slice().reverse(),...e.submaps.slice().reverse(),...e.background.slice().reverse()]}static addElement(e,r){const t={...e};switch(r.layer){case"background":t.background=[...e.background,r];break;case"submaps":t.submaps=[...e.submaps,r];break;case"locations":t.locations=[...e.locations,r];break}return t}static removeElement(e,r){return{background:e.background.filter(t=>t.id!==r),submaps:e.submaps.filter(t=>t.id!==r),locations:e.locations.filter(t=>t.id!==r)}}static updateElement(e,r,t){const a=x=>x.map(b=>b.id===r?{...b,...t}:b);return{background:a(e.background),submaps:a(e.submaps),locations:a(e.locations)}}static findElement(e,r){return this.getAllElementsOrdered(e).find(a=>a.id===r)||null}static getLayerCounts(e){return{background:e.background.length,submaps:e.submaps.length,locations:e.locations.length}}}class J{static isPointInElement(e,r){const t=q.tolerance;return e.x>=r.x-t&&e.x<=r.x+r.width+t&&e.y>=r.y-t&&e.y<=r.y+r.height+t}static selectElementAtPosition(e,r){const t=R.getAllElementsReverseOrder(e);for(const a of t)if(this.isPointInElement(r,a))return a;return null}static getResizeHandles(e){return[{name:"nw",x:e.x,y:e.y},{name:"ne",x:e.x+e.width,y:e.y},{name:"sw",x:e.x,y:e.y+e.height},{name:"se",x:e.x+e.width,y:e.y+e.height}]}static getResizeHandle(e,r){const t=this.getResizeHandles(r),a=q.handleSize;for(const x of t)if(Math.abs(e.x-x.x)<a&&Math.abs(e.y-x.y)<a)return x.name;return null}}class I{static createBackgroundElement(e,r,t,a,x,c="Customizado"){const b=Me[c];return{id:e,layer:"background",type:c,name:`Background ${e}`,x:r,y:t,width:a,height:x,color:b.color,borderColor:b.borderColor}}static createSubmapElement(e,r,t,a,x){return{id:e,layer:"submaps",type:"Setor",name:`Submapa ${e}`,x:r,y:t,width:a,height:x,color:"#DBEAFE",borderColor:"#3B82F6"}}static createLocationElement(e,r,t,a,x,c="Outros"){return{id:e,layer:"locations",type:c,name:`Local ${e}`,x:r,y:t,width:a,height:x,color:Q[c],borderColor:this.getBorderColorForCategory(c)}}static getBorderColorForCategory(e){return{AlimentaÃ§Ã£o:"#2E7D32",VestuÃ¡rio:"#1565C0",Artesanato:"#E65100",ServiÃ§os:"#6A1B9A",Outros:"#455A64"}[e]}static resizeElement(e,r,t){const a={};switch(r){case"nw":a.width=e.width+(e.x-t.x),a.height=e.height+(e.y-t.y),a.x=t.x,a.y=t.y;break;case"ne":a.width=t.x-e.x,a.height=e.height+(e.y-t.y),a.y=t.y;break;case"sw":a.width=e.width+(e.x-t.x),a.height=t.y-e.y,a.x=t.x;break;case"se":a.width=t.x-e.x,a.height=t.y-e.y;break}return a.width!==void 0&&(a.width=Math.max(10,a.width)),a.height!==void 0&&(a.height=Math.max(10,a.height)),a}}class Se{static getContrastColor(e){const r=parseInt(e.slice(1,3),16),t=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);return(r*299+t*587+a*114)/1e3>155?"#000000":"#FFFFFF"}static colorToHex(e){return e.startsWith("#"),e}static getNextLocationColor(e){const r=Object.values(Q),a=(r.indexOf(e)+1)%r.length;return r[a]}}function Oe(){const n=i.useRef(null),e=i.useRef(1),[r,t]=i.useState(R.createEmptyLayers()),[a,x]=i.useState(null),[c,b]=i.useState("select"),[v,S]=i.useState(null),[N,A]=i.useState(!1),[h,E]=i.useState({isDrawing:!1,isDragging:!1,isResizing:!1,drawStart:null,dragOffset:{x:0,y:0},resizeHandle:null}),[m,y]=i.useState({mousePos:{x:0,y:0},canvasPos:{x:0,y:0},lastHitTest:[]}),{render:w,drawPreviewElement:V,drawResizeHandles:Z,updateCursor:_,getRenderer:K,screenToWorld:Y}=xe(n),H=i.useRef(null),[L,z]=i.useState(null),M=i.useCallback(o=>{if(!n.current)return{x:0,y:0};const l=n.current.getBoundingClientRect(),u=o.clientX-l.left,d=o.clientY-l.top,f=Y(u,d);return N&&y(g=>({...g,mousePos:{x:o.clientX,y:o.clientY},canvasPos:f})),f},[N,Y]),D=i.useCallback(o=>{const l=J.selectElementAtPosition(r,o);if(N){const u=l?`âœ“ HIT: ${l.name} (${l.layer})`:"âœ— No element found";y(d=>({...d,lastHitTest:[u]}))}return l},[r,N]),F=i.useCallback((o,l)=>{t(u=>R.updateElement(u,o,l)),a&&a.id===o&&x(u=>u?{...u,...l}:null)},[a]),G=i.useCallback((o,l,u,d,f)=>{const g=Math.min(o,u),j=Math.min(l,d),k=Math.abs(u-o),C=Math.abs(d-l);if(k<10||C<10){console.debug("[FairMapper] createNewElement aborted: element too small");return}const U=e.current++;let O;switch(f){case"background":O=I.createBackgroundElement(U,g,j,k,C);break;case"submaps":O=I.createSubmapElement(U,g,j,k,C);break;case"locations":O=I.createLocationElement(U,g,j,k,C);break}t(me=>R.addElement(me,O)),x(O)},[]),p=i.useCallback(()=>{w(r,a,N,m),a&&c==="resize"&&Z(a)},[r,a,N,m,c,w,Z]);i.useEffect(()=>{const o=K();if(o){const l=H.current;l&&L?o.setBackgroundImage(l,{opacity:L.opacity,x:L.x,y:L.y,width:L.width,height:L.height}):o.setBackgroundImage(null)}p()},[L,n,p]);const T=i.useCallback(o=>{const{x:l,y:u}=M(o);if(c==="select"){const d=D({x:l,y:u});x(d)}else if(c==="paint"){const d=D({x:l,y:u});if(d){x(d);const f=Se.getNextLocationColor(d.color);F(d.id,{color:f}),p()}}},[c,a,M,D,F,p]),P=i.useCallback(o=>{const{x:l,y:u}=M(o);if(console.debug("[FairMapper] mouseDown",{x:l,y:u,currentLayer:v,currentTool:c}),v&&c==="draw")E(d=>({...d,isDrawing:!0,drawStart:{x:l,y:u}}));else if(c==="move"||c==="resize"){const d=D({x:l,y:u});if(d){if(x(d),c==="move")E(f=>({...f,isDragging:!0,dragOffset:{x:l-d.x,y:u-d.y}}));else if(c==="resize"){const f=J.getResizeHandle({x:l,y:u},d);f&&E(g=>({...g,isResizing:!0,resizeHandle:f}))}}}},[v,c,M,D]),W=i.useCallback(o=>{const{x:l,y:u}=M(o);if(h.isDrawing&&h.drawStart&&v)p(),V(h.drawStart.x,h.drawStart.y,l,u,v);else if(h.isDragging&&a){const d=l-h.dragOffset.x,f=u-h.dragOffset.y;F(a.id,{x:d,y:f})}else if(h.isResizing&&a&&h.resizeHandle){const d=I.resizeElement(a,h.resizeHandle,{x:l,y:u});F(a.id,d)}_(c,h.isDragging)},[h,a,v,c,M,V,_,p,F]),B=i.useCallback(o=>{const{x:l,y:u}=M(o);console.debug("[FairMapper] mouseUp",{x:l,y:u,mouseState:h,currentLayer:v}),h.isDrawing&&h.drawStart&&v&&(G(h.drawStart.x,h.drawStart.y,l,u,v),S(null)),E(d=>({...d,isDrawing:!1,isDragging:!1,isResizing:!1,drawStart:null,resizeHandle:null}))},[h,v,M,G]),$=i.useCallback(o=>{o.preventDefault(),E({isDrawing:!1,isDragging:!1,isResizing:!1,drawStart:null,dragOffset:{x:0,y:0},resizeHandle:null}),S(null)},[]),ee=i.useCallback(o=>{t(l=>R.removeElement(l,o)),a&&a.id===o&&x(null)},[a]),se=i.useCallback(o=>{b(o),S(null),x(null),E({isDrawing:!1,isDragging:!1,isResizing:!1,drawStart:null,dragOffset:{x:0,y:0},resizeHandle:null})},[]),te=i.useCallback(o=>{b("draw"),S(o),x(null)},[]),re=i.useCallback(o=>{x(o)},[]),ae=i.useCallback(()=>{A(o=>!o)},[]),ne=i.useCallback(()=>{const o={layers:r,nextId:e.current,timestamp:new Date().toISOString(),version:"1.0"},l=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),u=URL.createObjectURL(l),d=document.createElement("a");d.href=u,d.download=`mapa-feira-${new Date().toISOString().split("T")[0]}.json`,d.click(),URL.revokeObjectURL(u)},[r]),oe=i.useCallback(async o=>new Promise((l,u)=>{const d=new FileReader;d.onload=f=>{try{const g=JSON.parse(f.target?.result);t(g.layers||R.createEmptyLayers()),e.current=g.nextId||1,x(null),l()}catch(g){g instanceof Error?u(g):u(new Error(String(g)))}},d.onerror=()=>u(new Error("Erro ao ler arquivo")),d.readAsText(o)}),[]),ie=i.useCallback((o,l)=>{t(o),l!==void 0&&(e.current=l),x(null)},[]),le=i.useCallback(o=>new Promise((l,u)=>{const d=new FileReader;d.onload=()=>{const f=String(d.result??""),g=new Image;g.onload=()=>{H.current=g;const j=n.current;let k=j?j.clientWidth:0,C=j?j.clientHeight:0;(!k||k<10)&&(k=g.naturalWidth||g.width||800),(!C||C<10)&&(C=g.naturalHeight||g.height||600),console.debug("[FairMapper] background image loaded",{file:o.name,cssWidth:k,cssHeight:C,naturalWidth:g.naturalWidth,naturalHeight:g.naturalHeight}),z({src:f,opacity:.5,x:0,y:0,width:k,height:C,naturalWidth:g.naturalWidth,naturalHeight:g.naturalHeight}),p(),l()},g.onerror=j=>u(j),g.src=f},d.onerror=()=>u(new Error("Erro ao carregar imagem")),d.readAsDataURL(o)}),[n,p]),ce=i.useCallback(o=>{z(l=>l&&{...l,opacity:o})},[]),de=i.useCallback((o,l,u,d)=>{z(f=>f&&{...f,x:o,y:l,width:u,height:d})},[]),ue=i.useCallback(()=>{H.current=null,z(null),p()},[p]);return i.useEffect(()=>{const o=n.current;if(o)return o.addEventListener("click",T),o.addEventListener("mousedown",P),o.addEventListener("mousemove",W),o.addEventListener("mouseup",B),window.addEventListener("mouseup",B),o.addEventListener("contextmenu",$),()=>{o.removeEventListener("click",T),o.removeEventListener("mousedown",P),o.removeEventListener("mousemove",W),o.removeEventListener("mouseup",B),window.removeEventListener("mouseup",B),o.removeEventListener("contextmenu",$)}},[T,P,W,B,$]),i.useEffect(()=>{p()},[p,r]),i.useEffect(()=>{const o=()=>{p()};return window.addEventListener("canvas-resized",o),()=>{window.removeEventListener("canvas-resized",o)}},[p]),{layers:r,selectedElement:a,currentTool:c,currentLayer:v,debugMode:N,debugInfo:m,mouseState:h,setTool:se,setDrawMode:te,selectElement:re,updateElement:F,deleteElement:ee,toggleDebugMode:ae,saveMap:ne,loadMap:oe,loadLayers:ie,render:p,canvasRef:n,uploadBackgroundImage:le,setBackgroundOpacity:ce,setBackgroundTransform:de,removeBackgroundImage:ue,backgroundMeta:L}}function Re({layers:n}){const e=R.getLayerCounts(n),r=[{key:"locations",name:"Locais",color:"#EF4444",zIndex:3},{key:"submaps",name:"Submapas",color:"#3B82F6",zIndex:2},{key:"background",name:"Background",color:"#6B7280",zIndex:1}];return s.jsxs("div",{className:"p-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Camadas"}),s.jsx("div",{className:"space-y-1.5",children:r.map(t=>s.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-gray-50",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:t.color}}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-medium text-gray-900",children:t.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Z: ",t.zIndex]})]})]}),s.jsx("div",{className:"text-xs font-semibold text-gray-600",children:e[t.key]})]},t.key))})]})}function Fe({isOpen:n,onClose:e,onConfirm:r,element:t}){if(!n||!t)return null;const a=()=>{r(),e()};return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4 text-center",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 transition-opacity",onClick:e}),s.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[s.jsx("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:s.jsxs("div",{className:"sm:flex sm:items-start",children:[s.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:s.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),s.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[s.jsx("h3",{className:"text-base font-semibold leading-6 text-gray-900",id:"modal-title",children:"Excluir elemento"}),s.jsxs("div",{className:"mt-2",children:[s.jsxs("p",{className:"text-sm text-gray-500",children:["Tem certeza que deseja excluir o elemento"," ",s.jsx("span",{className:"font-semibold",children:t.name}),"?"]}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Esta aÃ§Ã£o nÃ£o pode ser desfeita."})]})]})]})}),s.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[s.jsx("button",{type:"button",onClick:a,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",children:"Excluir"}),s.jsx("button",{type:"button",onClick:e,className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Cancelar"})]})]})]})})}function De({selectedElement:n,onUpdateElement:e,onDeleteElement:r}){const{id:t}=he(),a=t&&t!=="new",{data:x}=ge(a?{mapId:t,limit:100}:void 0),[c,b]=i.useState({name:"",type:"",color:"#000000",x:0,y:0,width:0,height:0,storeId:""}),[v,S]=i.useState(!1),N=m=>{const y=x?.data?.find(w=>w._id===m);y&&n?(b(w=>({...w,storeId:m,name:y.name})),e(n.id,{name:y.name,storeId:m||void 0,storeName:y.name,storeCategory:y.category,storeLogo:y.logo||void 0})):m?b(w=>({...w,storeId:m})):(b(w=>({...w,storeId:""})),n&&e(n.id,{storeId:void 0,storeName:void 0,storeCategory:void 0,storeLogo:void 0}))};i.useEffect(()=>{b(n?{name:n.name||"",type:n.type||"",color:n.color||"#000000",x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height),storeId:n.storeId||""}:{name:"",type:"",color:"#000000",x:0,y:0,width:0,height:0,storeId:""})},[n]);const A=()=>{n&&r(n.id)},h=(m,y)=>{const w={...c,[m]:y};b(w),n&&e(n.id,{[m]:y===""&&m==="storeId"?void 0:y})},E=()=>{if(!n)return[];switch(n.layer){case"background":return["Corredor","PraÃ§a","Ãrea Comum","Entrada","Banheiro","Customizado"];case"submaps":return["Setor"];case"locations":return["AlimentaÃ§Ã£o","VestuÃ¡rio","Artesanato","ServiÃ§os","Outros"];default:return[]}};return s.jsxs("div",{className:"p-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Propriedades"}),n?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Nome"}),s.jsx("input",{type:"text",value:c.name,onChange:m=>h("name",m.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tipo"}),s.jsx("select",{value:c.type,onChange:m=>h("type",m.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:E().map(m=>s.jsx("option",{value:m,children:m},m))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Cor"}),s.jsx("input",{type:"color",value:c.color,onChange:m=>h("color",m.target.value),className:"w-full h-8 border border-gray-300 rounded-md shadow-sm cursor-pointer"})]}),n.layer==="locations"&&a&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Vincular Loja/EspaÃ§o"}),s.jsxs("select",{value:c.storeId||"",onChange:m=>N(m.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Sem vÃ­nculo"}),x?.data?.map(m=>s.jsx("option",{value:m._id,children:m.name},m._id))]}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Vincule este espaÃ§o a uma loja cadastrada. O nome serÃ¡ copiado automaticamente."})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"X"}),s.jsx("input",{type:"number",value:c.x,onChange:m=>h("x",parseInt(m.target.value)||0),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Y"}),s.jsx("input",{type:"number",value:c.y,onChange:m=>h("y",parseInt(m.target.value)||0),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Largura"}),s.jsx("input",{type:"number",value:c.width,onChange:m=>h("width",parseInt(m.target.value)||0),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Altura"}),s.jsx("input",{type:"number",value:c.height,onChange:m=>h("height",parseInt(m.target.value)||0),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsx("div",{className:"flex gap-2",children:s.jsx("button",{onClick:()=>S(!0),className:"flex-1 px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",children:"Excluir"})})]}):s.jsx("div",{className:"text-xs text-gray-500",children:"Selecione um elemento para editar suas propriedades"}),s.jsx(Fe,{isOpen:v,onClose:()=>S(!1),onConfirm:A,element:n})]})}function ze({layers:n,selectedElement:e,debugMode:r,debugInfo:t,onUpdateElement:a,onDeleteElement:x}){return s.jsxs("div",{className:"w-72 lg:w-80 bg-white border-l shadow-sm flex flex-col overflow-hidden",children:[s.jsx("div",{className:"border-b flex-shrink-0",children:s.jsx(Re,{layers:n,selectedElement:e})}),s.jsx("div",{className:"flex-1 border-b overflow-y-auto",children:s.jsx(De,{selectedElement:e,onUpdateElement:a,onDeleteElement:x})}),r&&s.jsx("div",{className:"h-48 flex-shrink-0 overflow-y-auto",children:s.jsx(Le,{debugInfo:t,selectedElement:e,visible:r})})]})}function Ie({currentTool:n,currentLayer:e,onToolChange:r,onLayerChange:t}){const a=[{id:"select",label:"Selecionar",title:"Selecionar elementos",icon:ke},{id:"move",label:"Mover",title:"Mover elementos",icon:be},{id:"resize",label:"Redimensionar",title:"Redimensionar elementos",icon:ve},{id:"paint",label:"Pintar",title:"Alterar cor dos elementos",icon:Ne}],x=[{id:"background",label:"Background",title:"Desenhar elementos de fundo",icon:X},{id:"submaps",label:"Submapa",title:"Desenhar submapas/setores",icon:X},{id:"locations",label:"Local",title:"Desenhar locais/lojas",icon:we}];return s.jsx("div",{className:"bg-white border-b shadow-sm flex-shrink-0",children:s.jsx("div",{className:"px-4 sm:px-6",children:s.jsxs("div",{className:"flex items-center justify-between py-3",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Ferramentas"}),s.jsx("div",{className:"flex items-center space-x-2",children:a.map(c=>{const b=c.icon;return s.jsxs("button",{onClick:()=>r(c.id),title:c.title,className:`flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ${n===c.id?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 border border-transparent"}`,children:[s.jsx(b,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden lg:inline",children:c.label})]},c.id)})})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Desenhar"}),s.jsx("div",{className:"flex items-center space-x-2",children:x.map(c=>{const b=c.icon;return s.jsxs("button",{onClick:()=>t(c.id),title:c.title,className:`flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ${e===c.id?"bg-green-50 text-green-700 border border-green-200":"text-gray-700 hover:bg-gray-50 border border-transparent"}`,children:[s.jsx(b,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden lg:inline",children:c.label})]},c.id)})})]})]})})})}export{ze as S,Ie as T,Oe as u};
